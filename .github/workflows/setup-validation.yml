name: E-Shop AI Analysis (Safe Mode)

on:
  push:
    branches: [ main, develop, feature/* ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  setup-validation:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ›ï¸ Checkout Repository
      uses: actions/checkout@v4
      
    - name: ğŸŸ¢ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: ğŸ“‹ Check Project Structure
      run: |
        echo "ğŸ” Checking project structure..."
        echo "ğŸ“ Root directory contents:"
        ls -la
        
        echo "ğŸ”§ Checking for tools directory:"
        if [ -d "tools" ]; then
          echo "âœ… tools/ directory exists"
          ls -la tools/
        else
          echo "âŒ tools/ directory not found"
        fi
        
        echo "ğŸ¤– Checking for Gemini CLI:"
        if [ -d "tools/gemini-cli" ]; then
          echo "âœ… tools/gemini-cli/ directory exists"
          ls -la tools/gemini-cli/
        else
          echo "âŒ tools/gemini-cli/ directory not found"
        fi
        
        echo "ğŸ“¦ Checking package.json:"
        if [ -f "package.json" ]; then
          echo "âœ… package.json exists"
          echo "ğŸ” Checking npm scripts:"
          npm run --silent | grep "cli:" || echo "âš ï¸ No CLI scripts found"
        else
          echo "âŒ package.json not found"
        fi
        
    - name: ğŸ”§ Setup Check
      run: |
        echo "ğŸ” Checking secrets setup:"
        if [ -n "${{ secrets.GEMINI_API_KEY }}" ]; then
          echo "âœ… GEMINI_API_KEY secret is configured"
        else
          echo "âš ï¸ GEMINI_API_KEY secret not found"
          echo "ğŸ“ To add it:"
          echo "   1. Go to Settings â†’ Secrets and variables â†’ Actions"
          echo "   2. Click 'New repository secret'"
          echo "   3. Name: GEMINI_API_KEY"
          echo "   4. Value: Your actual Gemini API key"
        fi
        
        echo "ğŸ¯ Next steps:"
        echo "1. Add GEMINI_API_KEY secret if missing"
        echo "2. Ensure all files are committed and pushed"
        echo "3. Re-run the workflows"
        
    - name: ğŸ“¤ Setup Report
      run: |
        echo "ğŸ“Š Setup Validation Complete"
        echo "âœ… This workflow validates the basic setup"
        echo "ğŸ”„ Once setup is complete, the main AI workflows will work"
